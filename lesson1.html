<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>미디어 + 스크립트</title>
<style>
  :root{
    --bg:#0b1020; --border:rgba(255,255,255,.12);
    --text:#e9ecf5; --muted:#aab3d6; --radius:16px;
    --shadow:0 12px 28px rgba(0,0,0,.35);
    --sans: ui-sans-serif, system-ui, -apple-system, "Apple SD Gothic Neo", "Noto Sans KR", Segoe UI, Roboto, Helvetica, Arial;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:var(--sans);color:var(--text);background:var(--bg);padding:18px}
  .frame{
    max-width:1200px;margin:0 auto;border:1px solid var(--border);border-radius:var(--radius);
    background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
    box-shadow:var(--shadow);overflow:hidden
  }
  .hd{padding:12px 14px;border-bottom:1px solid var(--border);background:rgba(0,0,0,.18);
      display:flex;justify-content:space-between;gap:10px;align-items:center}
  .hd .title{font-weight:700;font-size:14px}
  .hd .meta{font-size:12px;color:var(--muted)}
  .lesson{display:grid;grid-template-columns:1fr;gap:12px;padding:14px}
  @media (min-width:980px){.lesson{grid-template-columns:1fr 2fr}}
  .pane{
    border:1px solid var(--border);border-radius:14px;overflow:hidden;background:rgba(0,0,0,.18);
    min-height:480px;display:flex;flex-direction:column
  }
  .pane-hd{padding:10px 12px;border-bottom:1px solid var(--border);background:rgba(0,0,0,.18);
           display:flex;justify-content:space-between;gap:10px;align-items:center}
  .pane-hd strong{font-size:13px}
  .pane-hd .small{font-size:12px;color:var(--muted)}
  .pane-bd{padding:12px;flex:1 1 auto;min-height:0}
  .pane-bd.scrollable{overflow:auto}
  .iframe-wrap{position:relative;width:100%;aspect-ratio:16/9;border:1px solid var(--border);border-radius:12px;overflow:hidden;background:#000}
  .iframe-wrap iframe{position:absolute;inset:0;width:100%;height:100%;border:0}
  .content{white-space:pre-wrap;line-height:1.65;font-size:14px}
  .hint{font-size:12px;color:var(--muted);line-height:1.5}
  .media-controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:10px}
  button{border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--text);padding:8px 10px;border-radius:10px;cursor:pointer;font-weight:700}
  button.primary{background:rgba(106,169,255,.14)}
  .chip{font-size:12px;color:var(--muted);border:1px solid var(--border);padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.04)}
  audio{width:100%}
</style>
</head>
<body>
<div class="frame">
  <div class="hd">
    <div class="title">미디어 + 스크립트</div>
    <div class="meta" id="meta"></div>
  </div>
  <div class="lesson">
    <div class="pane">
      <div class="pane-hd">
        <div><strong>미디어</strong> <span class="small">왼쪽 1/3</span></div>
        <span class="small" id="mtype">-</span>
      </div>
      <div class="pane-bd" id="mediaHost"></div>
    </div>
    <div class="pane">
      <div class="pane-hd">
        <div><strong>스크립트/설명/문제</strong> <span class="small">오른쪽 2/3 (스크롤)</span></div>
        <span class="small">1654 chars</span>
      </div>
      <div class="pane-bd scrollable">
        <div class="content">[학습 목표]
- 핵심 개념 3가지를 설명할 수 있다.

[스크립트]
(아래는 길게 테스트용 텍스트입니다.)
1) 도입: 오늘의 주제는 ...
2) 본론: 핵심 포인트는 ...
3) 정리: 요약하면 ...

[확인 문제]
Q1. 핵심 포인트 1은 무엇인가?
Q2. 예외 상황은 무엇인가?
Q3. 임상/실무 적용 예시를 1개 들어보라.

[추가 자료]
- 문단을 많이 붙여넣으면 오른쪽에 스크롤이 생깁니다.
- 이 영역은 패널 높이에 맞춰 내부 스크롤(overflow:auto)로 동작합니다.

[학습 목표]
- 핵심 개념 3가지를 설명할 수 있다.

[스크립트]
(아래는 길게 테스트용 텍스트입니다.)
1) 도입: 오늘의 주제는 ...
2) 본론: 핵심 포인트는 ...
3) 정리: 요약하면 ...

[확인 문제]
Q1. 핵심 포인트 1은 무엇인가?
Q2. 예외 상황은 무엇인가?
Q3. 임상/실무 적용 예시를 1개 들어보라.

[추가 자료]
- 문단을 많이 붙여넣으면 오른쪽에 스크롤이 생깁니다.
- 이 영역은 패널 높이에 맞춰 내부 스크롤(overflow:auto)로 동작합니다.

[학습 목표]
- 핵심 개념 3가지를 설명할 수 있다.

[스크립트]
(아래는 길게 테스트용 텍스트입니다.)
1) 도입: 오늘의 주제는 ...
2) 본론: 핵심 포인트는 ...
3) 정리: 요약하면 ...

[확인 문제]
Q1. 핵심 포인트 1은 무엇인가?
Q2. 예외 상황은 무엇인가?
Q3. 임상/실무 적용 예시를 1개 들어보라.

[추가 자료]
- 문단을 많이 붙여넣으면 오른쪽에 스크롤이 생깁니다.
- 이 영역은 패널 높이에 맞춰 내부 스크롤(overflow:auto)로 동작합니다.

[학습 목표]
- 핵심 개념 3가지를 설명할 수 있다.

[스크립트]
(아래는 길게 테스트용 텍스트입니다.)
1) 도입: 오늘의 주제는 ...
2) 본론: 핵심 포인트는 ...
3) 정리: 요약하면 ...

[확인 문제]
Q1. 핵심 포인트 1은 무엇인가?
Q2. 예외 상황은 무엇인가?
Q3. 임상/실무 적용 예시를 1개 들어보라.

[추가 자료]
- 문단을 많이 붙여넣으면 오른쪽에 스크롤이 생깁니다.
- 이 영역은 패널 높이에 맞춰 내부 스크롤(overflow:auto)로 동작합니다.

[학습 목표]
- 핵심 개념 3가지를 설명할 수 있다.

[스크립트]
(아래는 길게 테스트용 텍스트입니다.)
1) 도입: 오늘의 주제는 ...
2) 본론: 핵심 포인트는 ...
3) 정리: 요약하면 ...

[확인 문제]
Q1. 핵심 포인트 1은 무엇인가?
Q2. 예외 상황은 무엇인가?
Q3. 임상/실무 적용 예시를 1개 들어보라.

[추가 자료]
- 문단을 많이 붙여넣으면 오른쪽에 스크롤이 생깁니다.
- 이 영역은 패널 높이에 맞춰 내부 스크롤(overflow:auto)로 동작합니다.

[학습 목표]
- 핵심 개념 3가지를 설명할 수 있다.

[스크립트]
(아래는 길게 테스트용 텍스트입니다.)
1) 도입: 오늘의 주제는 ...
2) 본론: 핵심 포인트는 ...
3) 정리: 요약하면 ...

[확인 문제]
Q1. 핵심 포인트 1은 무엇인가?
Q2. 예외 상황은 무엇인가?
Q3. 임상/실무 적용 예시를 1개 들어보라.

[추가 자료]
- 문단을 많이 붙여넣으면 오른쪽에 스크롤이 생깁니다.
- 이 영역은 패널 높이에 맞춰 내부 스크롤(overflow:auto)로 동작합니다.</div>
      </div>
    </div>
  </div>
</div>

<script>
  const url = "https://www.youtube.com/watch?v=dQw4w9WgXcQ";

  function isAudioUrl(u){
    try{ const x=new URL(u); return /(\.mp3|\.m4a|\.ogg|\.wav|\.webm)$/i.test(x.pathname); }catch(e){ return false; }
  }
  function parseYouTubeId(u){
    try{
      const x=new URL(u);
      if(x.hostname.includes("youtu.be")) return x.pathname.replace("/","");
      if(x.hostname.includes("youtube.com")){
        const v=x.searchParams.get("v"); if(v) return v;
        const m=x.pathname.match(/\/shorts\/([^\/]+)/); if(m) return m[1];
        const e=x.pathname.match(/\/embed\/([^\/]+)/); if(e) return e[1];
      }
      return null;
    }catch(e){ return null; }
  }
  function parseVimeoId(u){
    try{
      const x=new URL(u);
      if(!x.hostname.includes("vimeo.com")) return null;
      const m=x.pathname.match(/\/(\d+)/);
      return m?m[1]:null;
    }catch(e){ return null; }
  }

  const meta = document.getElementById("meta");
  const host = document.getElementById("mediaHost");
  const mtype = document.getElementById("mtype");

  meta.textContent = "Source: " + (url || "-");

  if(!url){
    host.innerHTML = '<div class="hint">미디어 링크가 비어 있습니다.</div>';
  }else{
    const yt = parseYouTubeId(url);
    const vm = parseVimeoId(url);

    host.innerHTML = `
      <div class="media-controls">
        <button class="primary" id="btnPlay">재생</button>
        <button id="btnStop">정지</button>
        <span class="chip" id="chip">-</span>
      </div>
      <div id="stage"></div>`;

    const stage = document.getElementById("stage");
    const chip = document.getElementById("chip");
    const btnPlay = document.getElementById("btnPlay");
    const btnStop = document.getElementById("btnStop");

    // YouTube
    if(yt){
      mtype.textContent = "YouTube";
      chip.textContent = "YouTube Player API";
      stage.innerHTML = '<div class="iframe-wrap"><div id="ytMount" style="width:100%;height:100%"></div></div>';

      let player = null;

      function loadYtApi(){
        return new Promise((resolve)=>{
          if(window.YT && window.YT.Player) return resolve(true);
          const prev = window.onYouTubeIframeAPIReady;
          window.onYouTubeIframeAPIReady = function(){ if(typeof prev==="function") prev(); resolve(true); };
          const s=document.createElement("script");
          s.src="https://www.youtube.com/iframe_api"; s.async=true;
          s.onerror=()=>resolve(false);
          document.head.appendChild(s);
        });
      }

      loadYtApi().then((ok)=>{
        if(!ok){
          chip.textContent = "API 로딩 실패(버튼 제어 제한)";
          stage.innerHTML = '<div class="iframe-wrap"><iframe src="https://www.youtube.com/embed/'+encodeURIComponent(yt)+'?rel=0&modestbranding=1" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe></div>';
          btnPlay.onclick=()=>{};
          btnStop.onclick=()=>{};
          return;
        }
        player = new YT.Player("ytMount", { videoId: yt, playerVars: { rel:0, modestbranding:1 } });
        btnPlay.onclick=()=>{ try{ player.playVideo(); }catch(e){} };
        btnStop.onclick=()=>{ try{ player.stopVideo(); }catch(e){} };
      });
    }
    // Vimeo
    else if(vm){
      mtype.textContent = "Vimeo";
      chip.textContent = "Vimeo Player API";
      stage.innerHTML = '<div class="iframe-wrap"><iframe id="vimeoFrame" src="https://player.vimeo.com/video/'+encodeURIComponent(vm)+'" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe></div>';

      function loadVimeoApi(){
        return new Promise((resolve)=>{
          if(window.Vimeo && window.Vimeo.Player) return resolve(true);
          const s=document.createElement("script");
          s.src="https://player.vimeo.com/api/player.js"; s.async=true;
          s.onload=()=>resolve(true);
          s.onerror=()=>resolve(false);
          document.head.appendChild(s);
        });
      }

      loadVimeoApi().then((ok)=>{
        if(!ok){
          chip.textContent = "API 로딩 실패(버튼 제어 제한)";
          btnPlay.onclick=()=>{};
          btnStop.onclick=()=>{};
          return;
        }
        const frame = document.getElementById("vimeoFrame");
        const p = new Vimeo.Player(frame);
        btnPlay.onclick=()=>{ try{ p.play(); }catch(e){} };
        btnStop.onclick=async ()=>{ try{ await p.pause(); await p.setCurrentTime(0); }catch(e){} };
      });
    }
    // Audio
    else if(isAudioUrl(url)){
      mtype.textContent = "Audio";
      chip.textContent = "HTML Audio";
      stage.innerHTML = '<audio id="audioEl" controls preload="metadata" src="'+url.replace(/"/g,"&quot;")+'"></audio><div class="hint" style="margin-top:10px">오디오 파일은 서버 CORS/권한 설정에 따라 재생이 제한될 수 있습니다.</div>';
      const a = document.getElementById("audioEl");
      btnPlay.onclick=()=>{ try{ a.play(); }catch(e){} };
      btnStop.onclick=()=>{ try{ a.pause(); a.currentTime=0; }catch(e){} };
    }
    // Fallback
    else{
      mtype.textContent = "Link";
      chip.textContent = "Generic iframe (버튼 제어 제한)";
      stage.innerHTML = '<div class="hint">YouTube/Vimeo/Audio로 인식되지 않아 iframe으로 표시합니다. 버튼 제어는 제한됩니다.</div><div class="iframe-wrap" style="margin-top:10px"><iframe src="'+url.replace(/"/g,"&quot;")+'"></iframe></div>';
      btnPlay.onclick=()=>{};
      btnStop.onclick=()=>{};
    }
  }
</script>
</body>
</html>